generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String
  avatar    String
  forms     Form[]
  createdAt DateTime @default(now())
}

model Form {
  id           String       @id @default(uuid())
  slug         String       @unique
  title        String
  description  String?
  coverImage   String?
  isPublic     Boolean      @default(false)
  maxResponses Int?
  publicLink   String?
  adminId      String
  admin        User         @relation(fields: [adminId], references: [id], onDelete: Cascade)
  fields       FormField[]
  submissions  Submission[]
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

model FormField {
  id        String   @id @default(uuid())
  label     String
  type      String
  required  Boolean  @default(false)
  wordLimit Int?
  order     Int
  options   String[]
  formId    String
  form      Form     @relation(fields: [formId], references: [id], onDelete: Cascade)
  createdAt DateTime @default(now())

  answers Answer[]
}

model Answer {
  id           String     @id @default(uuid())
  value        Json
  fieldId      String
  submissionId String
  formField    FormField  @relation(fields: [fieldId], references: [id], onDelete: Cascade)
  submission   Submission @relation(fields: [submissionId], references: [id], onDelete: Cascade)
}

model Submission {
  id          String   @id @default(uuid())
  ipAddress   String?
  userAgent   String?
  formId      String
  form        Form?    @relation(fields: [formId], references: [id], onDelete: Cascade)
  answers     Answer[]
  submittedAt DateTime @default(now())
}

enum FormFieldType {
  text
  longtext
  email
  number
  radio
  checkbox
  dropdown
  date
}
